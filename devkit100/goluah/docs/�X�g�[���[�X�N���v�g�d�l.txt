
==========================================================================

	ストーリーモードスクリプト仕様
	
	since	:2003.09.27
	update	:2004.03.11 aki ver1.0

	※あんましチェックしてないのでうまくいかないとことかいっぱいありそう

==========================================================================


■全般

スクリプトは基本的に１行１命令で記述します。
各行の // 以降をコメントとして無視します。

以下の説明で <〜>となっているところは、そこになんかの値を
入れてねってことです。?は数字一文字です。

ストーリーは#includeを使って複数のファイルにわたって記述することができますが、
一番最初に読み込まれるのはストーリーディレクトリ中の"entry.txt"とします。

■ブロックとオプション

#で始まる行からをひとつの「ブロック」とします。
ブロック定義開始行から次のブロック定義が見つかる間の行に
そのブロックに対するオプションをいろいろ指定します。
対戦やデモなどはブロックの記述順に実行されます。

■必須ブロック

#settings
を必須とします。このブロックは、#include以外の他のどのブロックよりも
先に記述されていなければなりません。
このブロック内で、ストーリー名やストーリー概要などを定義します。

■ブロックの種類

#のあとに続く文字列でブロックの種類を定義します。
settings	前述
vs			対戦を行います
staff		スタッフロールを行います
demo		デモを行います
include		外部ファイル挿入（特殊）

■ブロックのオプション指定

付加可能なオプションの指定はブロックの種類によって異なります

●settingsに指定できるオプション

ver <バージョン>
	必須。ストーリースクリプト仕様のバージョンを指定します。
	現在のバージョン、1.0を指定します。

title <半角文字列>
	このストーリーのタイトルを指定します。
	ゲーム中では全角文字は表示できないので半角文字で指定してください。
	それから都合によりスペースがつかえません。"_"がスペースで置換されるのでそれを使ってください。
	指定がない場合は untitled になります。

icon <ファイル名>
	ストーリー選択時にアイコンとして使用する画像ファイルを指定します。
	256色ビットマップを指定できます。
	画像の標準サイズはキャラクタのミニ顔と同じ（50x50）です。

preview <ファイル名>
	ストーリー選択時にプレビュー(？)として使用する画像ファイルを指定します。
	256色ビットマップを指定できます。
	画像の標準サイズは 640x150 です。

char <名前 or %userselect> <色> <オプション>
	ストーリーの主役(?)となるキャラクタを指定します。※

continue <整数値>
	コンティニュー可能回数を指定します。
	指定なし、またはマイナス値で制限無し（何度でもコンティニュー可能）になります。

brief_begin
	ストーリーの概要を指定します。
	特殊オプションです。このオプションの次の行から brief_end の行までを
	テキストとして指定できます。（改行も有効）

brief_end
	brief_beginの終了指定です

※ char のサブオプション指定方法

キャラクタの指定
	キャラクタの名前で指定します。
	%userselect を指定するとユーザーに選ばさせます。

色の指定
	1-3を指定します。
	ただし、キャラクタの指定に %userselect が指定されている場合は無視され、
	ユーザーが選んだ値になります。

オプションの指定
	32桁の2進数で指定します。
	その場合排他・依存オプションは考慮されますが、ポイントの最大値は考慮されません。
	ユーザーに選ばせる場合は%userselectを指定します。
	キャラクタの指定に %userselect が指定されている場合は無視され、
	%userselect扱いになります。

備考
	#vsブロックでの指定は、記述順に char1 , char2 , char3 となります

●#vs に付加できるオプション

type ?
	試合の形式を指定します。
	1:同時対戦、2:交代無し、3:自由交代　です。指定のない場合、同時対戦になります。

friend <キャラクタ> <色> <オプション> <レベル>
	試合に登場する味方キャラクタを指定します。
	3つまで記述することができます。記述順がチーム内でのオーダーに影響します。
	指定がひとつもない場合は friend %char? - - +0 が適用されます。
	#settingsブロックでの char指定数が friend指定数より少ない場合はエラーです。
	※

enemy <キャラクタ> <色> <オプション> <レベル>
	friendと同様。敵側の指定です。指定がひとつもない場合、
	enemy %random 1 %random +0 が friend数分適用されます。
	※

stage <ステージ名 or %random>
	対戦するステージを指定します。
	指定のない場合、stage %randomが適用されます。

timelimit <整数値>
	制限時間を指定します。0以下を指定すると∞指定になります。
	同時対戦以外は設定しても意味ありません。
	指定のない場合は∞。

nowin
	勝利画面をスキップします。

wintext_begin
	勝利時の表示テキスト（台詞）を指定します。
	特殊オプションです。このオプションの次の行から wintext_end の行までを
	テキストとして指定できます。（改行も有効）

wintext_end
	wintext_begin の終了指定です。

losetext_begin
	wintext_begin と同様、こちらは負けたときの台詞指定です。

losetext_end
	losetext_begin の終了指定です。

bgm <ファイル名>
	試合で流れるBGMのファイル名を、拡張子ぬきで指定します。
	mp3、mid、wma、wav ファイルを指定できます
	ディレクトリはストーリーディレクトリを基準にします。


※ friend , enemy の値指定法

キャラクタの指定
	キャラクタ名 or %char1 or %char2 or %char3 or  %random　です。
	それぞれの予約語は、なんとなくわかるよね？
	settingブロックでchar指定してないのに %char1 or %char2 or %char3 を指定するとエラーです。

色の指定
	1〜3 or %auto です。
	%autoは最初1を適用し、重複する色を持つキャラクタがいる場合は順次2、3を適用します。
	キャラクタ指定が %char1-3で%autoの場合ユーザーが選択したカラーになります。

オプションの指定
	2進数値32桁 or %random です。
	直接指定の場合排他・依存オプションは考慮されますが、ポイントの最大値は考慮されません。
	%randamを指定すると、ランダムでオプションが選択されます。
	キャラクタ指定が %randomの場合は無視され、オプションも強制的にランダム指定になります。
	キャラクタ指定が %char1-3の場合は無視され、ユーザーの選んだ値になります。

レベル（COM難易度）の指定
	数字 or +数字 or -数字　です。
	数字は0からの整数を指定します。
	+数字 はSETTINGSの設定値からプラスいくつで指定します。
	-数字 は同様にSETTINGSの設定値マイナスいくつという指定になります。
	いずれも最大値、最小値をこえると、最大値、最小値が割り当てられ、
	また、キャラクタがCOM操作でない場合は無視されます。

●staff　に指定できるオプション

file <再生するファイル名>
	スタッフロールで流れる文字を記述したファイル名を指定します。
	指定のない場合・読み込みに失敗した場合は system/staff.txt が流れます。

●demo　に指定できるオプション

file <デモ記述ファイル名>
	再生するデモを記述したスクリプトファイルを指定します。
	デモのスクリプトの記述方法は、別途デモスクリプトファイル仕様を参照してください。

●include	

includeブロックだけ都合により特殊扱いで、ブロック記述中にオプションを指定します。

#include <ファイル名>

こんな感じで。




